\section{Methods}

\subsection{Study population}
57 patients with stable bronchiectasis were recruited as a part of this study by our collaborators in Milan, Italy. Recruitment of patients was performed cross-sectionally as a part of the Bronchiectasis Program of Fondazione IRCCS Ca' Granda Ospedale Maggiore Policlinico, Milan, Italy. Patients were enrolled during their clinical stability (at least one month apart from the last exacerbation and antibiotic course) and underwent clinical, radiological and microbiological evaluation. Patients were asked to provide a sputum and stool sample with a maximum gap of 12hrs between the sputum and stool sample. DNA was extracted by our lab members from the sputum and stool samples as described previously \cite{Mac1800766}. The extracted DNA was subjected to targeted amplicon sequencing of the 16S rRNA and ITS2 regions of the genome to derive the Microbiome and Mycobiome, by mapping them to green genes and UNITE databases, respectively.

\subsection{Data-preprocessing and Statistical analysis}

Only microbes present $\geq$1\% in at-least 5 patients were considered for all analyses. Read counts of Microbiome and Mycobiome datasets from the sputum and stool samples of the 57 samples were converted into relative abundances for the below analysis. Intersection analysis was performed on the columns of the microbiomes (bacteria and fungi from lung and gut) using the `intersection' function in R. Diversity of the individual microbiomes was measured using the Shannon-diversity index computed in R using the 'vegan' package. Differences between the median diversity between the sites were assessed using the Maan-Whitney U test. A p-value $< 0.05$ was considered statistically significant.

\subsection{Co-occurrence analysis}
Sequence analysis captures microbial composition on a relative scale, rendering microbiome datasets compositional and sparse. Hence, an absolute increase in the relative abundance of one species is accompanied by a compositional decrease in another, causing the problem of spurious correlations \cite{Aitchison1982}. To address this, Faust et al. developed a novel bootstrap and renormalisation (reboot) approach that mitigates these potential issues by calculating statistical significance thresholds that accounts for similarity due to pure compositionality \cite{Faust2012}. Microbial association networks using GBLM in confluence with reboot was implemented as described previously in \cite{Narayana2019}. This linear method only captures complex linear interactions between the microbes with the assumption that all the microbes can interact with each other. 
 
Sparse Inverse Covariance for Ecological Statistical Inference (spiec-easi) was implemented to estimate microbial association networks from the precision matrix within and between the four compositional microbial read-counts datasets (bacteria-lung, fungi-lung, bacteria-gut and fungi-gut), under the joint sparsity penalty \cite{Kurtz2015}. Speic-easi was implemented using the `multi.spiec.easi' function of the `SpiecEasi' package in R with the following parameters: method = glasso, lamda.min.ratio=1e-4, nlambda=200, re.number=100. The resulting networks was appended with edge weights calculated by scaling the inverse covariance matrix of the optimal network into a correlation matrix.


\subsection{Integrative analysis}
Multi Omic Factor Analysis (MOFA) was implemented to perform an unsupervised factor analysis on the integrated multibiome datasets. Broadly, MOFA , tries to infer an interpretable low-dimensional representation of the multibiome datasets in terms of latent factors \cite{Argelaguet2020}. Microbial read-counts of the multibiome datasets were centered log ratio (clr) transformed after addition of 0.1 to the read-counts followed by concatenation. This addition is necessary for computational stability, convergence and doesn't affect the overall value. MOFA was implemented on this transformed and concatenated dataset, using the `MOFA2' package in R and the following parameters: num\_factors = 3 and convergence\_mode=medium. The explained variance of each of these was calculated and plotted. Further, these factors were evaluated against clinical attributes to check for statistical differences between the median of the factor values between the groups defined by the clinical attributes. A non-parametric, dunn's test with Benjamin-Hochberg FDR correction OR a Maan-Whitney U test was implemented to assess the statistical significance between multiple groups, whenever appropriate. A p-value $< 0.05$ was considered statistically significant.

Weighted SNF analysis as developed and described, in Chapter1 and \cite{Narayana2019}, was implemented with k-nearest neighbours = 9 and weights equal to the taxonomical richness of the individual microbiomes on the multibiome datasets (bacteria-lung, bacteria-gut, fungi-lung and fungi-gut). Following this integration, spectral clustering was implemented with optimum number of clusters=2 to cluster the patients based on the integrated microbiomes. This analysis was performed using the web-tool developed in the previous chapter and available at \url{https://integrative-microbiomics.ntu.edu.sg}. The robustness of our identified clusters was assessed using a bootstrapping approach with 70\% of the integrated data being sampled over 100 bootstrap iterations followed by spectral clustering with k (number of clusters) = 2 on this 70\% bootstrap sample. The resulting bootstrap clusters (subsamples data, 70\%) were compared with the original clusters (100\%). A differential abundance analysis to identify discriminant taxa between the derived clusters was implemented using ALDEX2 \cite{Fernandes2014}. ALDEX2, uses a Dirichlet-multinomial model to infer abundance and sample variation from read-counts and calculates the expected false discovery rate given the biological and sampling variation using the given test. ALDEX2 was implemented using test =  Welches t-test, and the fdr corrected p-values calculated by the Benjamini Hochberg correction was computed. P-value $< 0.05$ was considered statistically significant and the corresponding taxa as a discriminant taxa. This was implemented in R using the ALDEX2 package with default parameters.